/*
 * To change this license header, choose License Headers in Project Properties.
 * To change this template file, choose Tools | Templates
 * and open the template in the editor.
 */
package LMS;


import DBConnection.DBConnect;
import LMS.code.Librarian;
import java.sql.Connection;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.util.logging.Level;
import java.util.logging.Logger;
import javax.swing.JOptionPane;
import net.proteanit.sql.DbUtils;
import SPMS.dbConnection;

/**
 *
 * @author sanjalee
 */
public class LMS_settings extends javax.swing.JInternalFrame {

    Connection conn = null;
    PreparedStatement pst = null;
    ResultSet rs = null;
    
    public LMS_settings() {
        initComponents();
        
        conn = DBConnect.connect();
        
        tableload();
    }
    
    public void tableload(){
    
    
         String sql_viewSettings = "SELECT id,noOfBooks, finePerDay, lostBookFine, timelimit FROM lms_settings";
        try {
            pst = conn.prepareStatement(sql_viewSettings );
            rs = pst.executeQuery();
        } catch (SQLException ex) {
            Logger.getLogger(LMS_ManageVendors.class.getName()).log(Level.SEVERE, null, ex);
        }
        
    
        jTableSettings.setModel(DbUtils.resultSetToTableModel(rs));
    
    
    }

    /**
     * This method is called from within the constructor to initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is always
     * regenerated by the Form Editor.
     */
    @SuppressWarnings("unchecked")
    // <editor-fold defaultstate="collapsed" desc="Generated Code">//GEN-BEGIN:initComponents
    private void initComponents() {

        Settings = new javax.swing.JPanel();
        jLabel49 = new javax.swing.JLabel();
        noofbooksbox = new javax.swing.JTextField();
        jLabel50 = new javax.swing.JLabel();
        fineperdaybox = new javax.swing.JTextField();
        jLabel51 = new javax.swing.JLabel();
        lostbookfinebox = new javax.swing.JTextField();
        timelimitbox = new javax.swing.JTextField();
        jLabel53 = new javax.swing.JLabel();
        jScrollPane11 = new javax.swing.JScrollPane();
        jTableSettings = new javax.swing.JTable();
        btnUpdateSettings = new javax.swing.JButton();
        jLabel1 = new javax.swing.JLabel();
        labelid = new javax.swing.JLabel();

        Settings.setBackground(new java.awt.Color(255, 255, 230));

        jLabel49.setFont(new java.awt.Font("Tahoma", 1, 14)); // NOI18N
        jLabel49.setForeground(new java.awt.Color(0, 26, 77));
        jLabel49.setText("No of books ");

        noofbooksbox.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                noofbooksboxActionPerformed(evt);
            }
        });

        jLabel50.setFont(new java.awt.Font("Tahoma", 1, 14)); // NOI18N
        jLabel50.setForeground(new java.awt.Color(0, 26, 77));
        jLabel50.setText("Fine Per Day");

        jLabel51.setFont(new java.awt.Font("Tahoma", 1, 14)); // NOI18N
        jLabel51.setForeground(new java.awt.Color(0, 26, 77));
        jLabel51.setText("Lost Book Fine");

        lostbookfinebox.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                lostbookfineboxActionPerformed(evt);
            }
        });

        jLabel53.setFont(new java.awt.Font("Tahoma", 1, 14)); // NOI18N
        jLabel53.setForeground(new java.awt.Color(0, 26, 77));
        jLabel53.setText("Time Limit Per Book");

        jTableSettings.setModel(new javax.swing.table.DefaultTableModel(
            new Object [][] {
                {null, null, null, null},
                {null, null, null, null},
                {null, null, null, null},
                {null, null, null, null}
            },
            new String [] {
                "Title 1", "Title 2", "Title 3", "Title 4"
            }
        ));
        jTableSettings.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                jTableSettingsMouseClicked(evt);
            }
        });
        jScrollPane11.setViewportView(jTableSettings);

        btnUpdateSettings.setBackground(new java.awt.Color(0, 77, 153));
        btnUpdateSettings.setFont(new java.awt.Font("Tahoma", 1, 14)); // NOI18N
        btnUpdateSettings.setForeground(new java.awt.Color(255, 255, 255));
        btnUpdateSettings.setText("Update");
        btnUpdateSettings.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnUpdateSettingsActionPerformed(evt);
            }
        });

        jLabel1.setFont(new java.awt.Font("Tahoma", 1, 14)); // NOI18N
        jLabel1.setForeground(new java.awt.Color(0, 26, 77));
        jLabel1.setText("ID");

        labelid.setFont(new java.awt.Font("Tahoma", 1, 14)); // NOI18N
        labelid.setForeground(new java.awt.Color(0, 26, 77));
        labelid.setText("ID");

        javax.swing.GroupLayout SettingsLayout = new javax.swing.GroupLayout(Settings);
        Settings.setLayout(SettingsLayout);
        SettingsLayout.setHorizontalGroup(
            SettingsLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(SettingsLayout.createSequentialGroup()
                .addGroup(SettingsLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(SettingsLayout.createSequentialGroup()
                        .addGroup(SettingsLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addGroup(SettingsLayout.createSequentialGroup()
                                .addGap(69, 69, 69)
                                .addGroup(SettingsLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                                    .addGroup(SettingsLayout.createSequentialGroup()
                                        .addGroup(SettingsLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                                            .addComponent(jLabel49)
                                            .addComponent(jLabel50))
                                        .addGap(67, 67, 67)
                                        .addGroup(SettingsLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                                            .addComponent(fineperdaybox, javax.swing.GroupLayout.PREFERRED_SIZE, 152, javax.swing.GroupLayout.PREFERRED_SIZE)
                                            .addComponent(noofbooksbox, javax.swing.GroupLayout.PREFERRED_SIZE, 152, javax.swing.GroupLayout.PREFERRED_SIZE)
                                            .addComponent(labelid)))
                                    .addGroup(SettingsLayout.createSequentialGroup()
                                        .addGroup(SettingsLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                                            .addComponent(jLabel51, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                                            .addComponent(jLabel53))
                                        .addGap(18, 18, 18)
                                        .addGroup(SettingsLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                                            .addComponent(lostbookfinebox, javax.swing.GroupLayout.PREFERRED_SIZE, 152, javax.swing.GroupLayout.PREFERRED_SIZE)
                                            .addComponent(timelimitbox, javax.swing.GroupLayout.PREFERRED_SIZE, 152, javax.swing.GroupLayout.PREFERRED_SIZE))))
                                .addGap(59, 59, 59))
                            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, SettingsLayout.createSequentialGroup()
                                .addContainerGap()
                                .addComponent(btnUpdateSettings)
                                .addGap(98, 98, 98)))
                        .addComponent(jScrollPane11, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                    .addGroup(SettingsLayout.createSequentialGroup()
                        .addGap(91, 91, 91)
                        .addComponent(jLabel1)))
                .addContainerGap(313, Short.MAX_VALUE))
        );
        SettingsLayout.setVerticalGroup(
            SettingsLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(SettingsLayout.createSequentialGroup()
                .addGroup(SettingsLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(SettingsLayout.createSequentialGroup()
                        .addGap(29, 29, 29)
                        .addGroup(SettingsLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                            .addComponent(jLabel1)
                            .addComponent(labelid))
                        .addGap(35, 35, 35)
                        .addGroup(SettingsLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                            .addComponent(jLabel49)
                            .addComponent(noofbooksbox, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                        .addGap(53, 53, 53)
                        .addGroup(SettingsLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                            .addComponent(jLabel50)
                            .addComponent(fineperdaybox, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                        .addGap(60, 60, 60)
                        .addGroup(SettingsLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                            .addComponent(jLabel51)
                            .addComponent(lostbookfinebox, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                        .addGap(55, 55, 55)
                        .addGroup(SettingsLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                            .addComponent(timelimitbox, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(jLabel53))
                        .addGap(61, 61, 61)
                        .addComponent(btnUpdateSettings))
                    .addGroup(SettingsLayout.createSequentialGroup()
                        .addGap(58, 58, 58)
                        .addComponent(jScrollPane11, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)))
                .addContainerGap(349, Short.MAX_VALUE))
        );

        javax.swing.GroupLayout layout = new javax.swing.GroupLayout(getContentPane());
        getContentPane().setLayout(layout);
        layout.setHorizontalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGap(0, 1200, Short.MAX_VALUE)
            .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                .addGroup(layout.createSequentialGroup()
                    .addGap(0, 0, Short.MAX_VALUE)
                    .addComponent(Settings, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addGap(0, 0, Short.MAX_VALUE)))
        );
        layout.setVerticalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGap(0, 834, Short.MAX_VALUE)
            .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                .addGroup(layout.createSequentialGroup()
                    .addGap(0, 0, Short.MAX_VALUE)
                    .addComponent(Settings, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addGap(0, 0, Short.MAX_VALUE)))
        );

        pack();
    }// </editor-fold>//GEN-END:initComponents

    private void noofbooksboxActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_noofbooksboxActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_noofbooksboxActionPerformed

    private void lostbookfineboxActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_lostbookfineboxActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_lostbookfineboxActionPerformed

    private void jTableSettingsMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_jTableSettingsMouseClicked
        
        int raw = jTableSettings.getSelectedRow();
        
        String id = jTableSettings.getValueAt(raw, 0).toString();
        String noOfBooks = jTableSettings.getValueAt(raw, 1).toString();
        String finePerDay = jTableSettings.getValueAt(raw, 2).toString();
        String lostBookFine = jTableSettings.getValueAt(raw, 3).toString();
        String timelimit = jTableSettings.getValueAt(raw, 4).toString();
        
        labelid.setText(id);
        noofbooksbox.setText(noOfBooks);
        fineperdaybox.setText(finePerDay);
        lostbookfinebox.setText(lostBookFine);
        timelimitbox.setText(timelimit);
        
    }//GEN-LAST:event_jTableSettingsMouseClicked

    private void btnUpdateSettingsActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnUpdateSettingsActionPerformed
        
        int isConfirmed = JOptionPane.showConfirmDialog(null, "Do you really want to update this information?");
        
        if(isConfirmed == 0){
            
            int id = Integer.parseInt(labelid.getText());
            int noOfBooks = Integer.parseInt(noofbooksbox.getText());
            double finePerDay = Double.parseDouble(fineperdaybox.getText());
            double lostBookFine = Double.parseDouble(lostbookfinebox.getText());
            int timelimit = Integer.parseInt(timelimitbox.getText());
            
            String sql_updateSettings = "UPDATE lms_settings "
                                      + "SET noOfBooks = '"+ noOfBooks +"', finePerDay = '"+ finePerDay +"', "
                                      + "lostBookFine = '"+ lostBookFine +"', timelimit = '"+ timelimit +"' "
                                      + "WHERE id ='"+ id +"'";
            
            try {
                pst = conn.prepareStatement(sql_updateSettings);
                pst.execute();
                JOptionPane.showMessageDialog(null,"Successfully Updated!!");
            } catch (SQLException ex) {
                Logger.getLogger(LMS_ManageMember.class.getName()).log(Level.SEVERE, null, ex);
            }
            
            tableload();
            
            labelid.setText(null);
            noofbooksbox.setText(null);
            fineperdaybox.setText(null);
            lostbookfinebox.setText(null);
            timelimitbox.setText(null);
            
        }
    }//GEN-LAST:event_btnUpdateSettingsActionPerformed


    // Variables declaration - do not modify//GEN-BEGIN:variables
    private javax.swing.JPanel Settings;
    private javax.swing.JButton btnUpdateSettings;
    private javax.swing.JTextField fineperdaybox;
    private javax.swing.JLabel jLabel1;
    private javax.swing.JLabel jLabel49;
    private javax.swing.JLabel jLabel50;
    private javax.swing.JLabel jLabel51;
    private javax.swing.JLabel jLabel53;
    private javax.swing.JScrollPane jScrollPane11;
    private javax.swing.JTable jTableSettings;
    private javax.swing.JLabel labelid;
    private javax.swing.JTextField lostbookfinebox;
    private javax.swing.JTextField noofbooksbox;
    private javax.swing.JTextField timelimitbox;
    // End of variables declaration//GEN-END:variables
}
